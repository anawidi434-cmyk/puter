<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>AI Image & Video Generator</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Puter.js -->
  <script src="https://js.puter.com/v2/"></script>
</head>
<body class="bg-gray-950 text-white min-h-screen">

  <div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-2">ğŸ¬ AI Image & Video Generator</h1>
    <p class="text-gray-400 mb-6">Gratis â€¢ Tanpa API Key â€¢ Tanpa Billing</p>

    <!-- Prompt -->
    <textarea
      id="prompt"
      class="w-full p-4 rounded bg-gray-900 border border-gray-700 focus:outline-none focus:ring focus:ring-blue-500"
      rows="3"
      placeholder="Contoh: Cinematic sunset over mountains, ultra realistic"
    ></textarea>

    <!-- Buttons -->
    <div class="flex gap-4 mt-4">
      <button
        onclick="generateImage()"
        class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-semibold"
      >
        ğŸ–¼ Generate Image
      </button>

      <button
        onclick="generateVideo()"
        class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded font-semibold"
      >
        ğŸ¥ Generate Video
      </button>
    </div>

    <!-- Loading -->
    <div id="loading" class="hidden mt-4 text-yellow-400">
      â³ Generating, please wait...
    </div>

    <!-- Result -->
    <div id="result" class="mt-8"></div>

    <!-- Gallery -->
    <h2 class="text-xl font-semibold mt-10 mb-4">ğŸ“ Gallery</h2>
    <div id="gallery" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
  </div>

<script>
  const loading = document.getElementById("loading");
  const result = document.getElementById("result");
  const gallery = document.getElementById("gallery");

  function showLoading(show) {
    loading.classList.toggle("hidden", !show);
  }

  function addToGallery(element, downloadUrl, type) {
    const card = document.createElement("div");
    card.className = "bg-gray-900 p-3 rounded border border-gray-700";

    const downloadBtn = document.createElement("a");
    downloadBtn.href = downloadUrl;
    downloadBtn.download = type === "video" ? "video.mp4" : "image.png";
    downloadBtn.textContent = "â¬‡ Download";
    downloadBtn.className =
      "inline-block mt-2 bg-gray-800 hover:bg-gray-700 px-3 py-1 rounded text-sm";

    card.appendChild(element);
    card.appendChild(downloadBtn);
    gallery.prepend(card);
  }

  // IMAGE
  function generateImage() {
    const prompt = document.getElementById("prompt").value.trim();
    if (!prompt) return alert("Prompt tidak boleh kosong");

    showLoading(true);
    result.innerHTML = "";

    puter.ai.txt2img(prompt)
      .then(img => {
        showLoading(false);
        img.className = "rounded border border-gray-700 max-w-full";
        result.appendChild(img);
        addToGallery(img.cloneNode(), img.src, "image");
      })
      .catch(err => {
        showLoading(false);
        alert("Gagal generate image");
        console.error(err);
      });
  }

  // VIDEO
  function generateVideo() {
    const prompt = document.getElementById("prompt").value.trim();
    if (!prompt) return alert("Prompt tidak boleh kosong");

    showLoading(true);
    result.innerHTML = "";

    puter.ai.txt2vid(prompt, {
      model: "sora-2",
      seconds: 8,
      size: "1280x720"
    })
    .then(video => {
      showLoading(false);
      video.controls = true;
      video.className = "rounded border border-gray-700 w-full";
      result.appendChild(video);

      const src = video.querySelector("source")?.src || video.src;
      addToGallery(video.cloneNode(true), src, "video");
      video.play().catch(()=>{});
    })
    .catch(err => {
      showLoading(false);
      alert("Gagal generate video");
      console.error(err);
    });
  }
</script>

</body>
</html>
